\o 4_1_2_SQL_log.txt

SELECT 
    u.userid,
    COUNT(ft.treasure_foundid) AS hunt_count,
    ROUND(AVG(ft.duration_seconds / 60.0), 2) AS avg_duration_minutes
FROM fact_treasure_found ft
JOIN dim_user u ON ft.usersk = u.usersk
GROUP BY u.userid
ORDER BY 
    hunt_count DESC, 
    avg_duration_minutes ASC
LIMIT 10000;

\o
